<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <script src="https://unpkg.com/htmx.org@1.4.1"></script>
    <script src="https://unpkg.com/hyperscript.org@0.8.1"></script>
    <title>cRF Calculator</title>
  </head>
  <body>
    <div class="container-xl">
      <div class="crf-input">
        <div class="row py-2">
            <div class="col-3 col-md-2 col-lg-1 text-end"><h5>CRF=</h5></div>
            <div class="col-6 col-md-6 col-lg-3" style="background-color: #efe; text-align: center;">
                <h4 style="color: #f00;" id="msg">&nbsp;</h4>
            </div>
        </div>
      </div>

      <div class="crf-input" id="thisone" hx-post="/crf_calc/" hx-target="#msg" hx-trigger="change" hx-include="[id='thisone']">

        <div class="row pt-2">
          <span class="col-4 col-lg-2">Blood Group</span>
          {% for bg in ['A','B','O','AB'] %}
          <div class="col-2 col-sm-2 col-lg-1 form-check form-check-solid">
              <input class="form-check-input" name="abo" type="radio" value="{{bg}}">
              <label class="form-check-label">{{bg}}</label>
          </div>
          {% endfor %}
        </div>


        <div class="row py-3">
          <span class="col-3 col-sm-2 col-lg-2">Version</span>
          <div class="col-2 col-sm-2 col-lg-1 form-check form-check-solid">
              <input class="form-check-input" name="ver" type="radio" value="0">
              <label class="form-check-label">Both</label>
          </div>
          <div class="col-2 col-sm-2 col-lg-1 form-check form-check-solid">
              <input class="form-check-input" name="ver" type="radio" value="1">
              <label class="form-check-label">1</label>
          </div>
          <div class="col-2 col-sm-2 col-lg-1 form-check form-check-solid">
              <input class="form-check-input" name="ver" type="radio" value="2" checked>
              <label class="form-check-label">2</label>
          </div>
          <div class="col-1 col-lg-6"></div>
          <div class="col-2 col-sm-2 col-lg-1 form-check form-check-solid">
              <input class="form-check-input" name="com" type="checkbox">
              <label class="form-check-labe" title="Blood group compatible/identical">&Sigma;</label>
          </div>           
      </div> 


        {% set ns = namespace(locus = 'A') %}
        <div class="row">
        {% for ag in antigens %}
            {% if ns.locus != ag.locus %} {% set ns.locus = ag.locus %}<div class="col-12 pb-2"></div>{% endif %}
            <div class="col-2 col-sm-2 col-lg-1 crf-input-{{ag.locus|lower()}}">
                <div class="form-check">
                    <input class="form-check-input antigen-checkbox" name="{{ag.antigen}}" id="{{ag.id}}" type="checkbox" />
                    <label class="form-check-label" for="{{ag.id}}">{{ag.antigen}}</label>
                </div>
            </div>
        {% endfor %}
      </div>
    </div>

    <style>
      .crf-input {
          color: #222;
      }
      .crf-input-a{
          background-color: #fdd;
      }
      .crf-input-b{
          background-color: #dfd;
      }
      .crf-input-bw{
          background-color: #eef;
      }
      .crf-input-cw{
          background-color: #ddf;
      }
      .crf-input-dr{
          background-color: #ffd;
      }
      .crf-input-dq{
          background-color: #dff;
      }
      
      </style>
  </body>
</html>